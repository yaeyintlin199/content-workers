npm warn Unknown env config "python". This will stop working in the next major version of npm.
npm warn Unknown project config "auto-install-peers". This will stop working in the next major version of npm.

> test
> vitest run --test-timeout=0 --hook-timeout=0 --silent


 RUN  v3.1.2 /home/engine/project

 âœ“ |@lucidcms/core| src/services/documents-bricks/helpers/construct-brick-table.test.ts (2 tests) 8ms
3:25:18 PM [vite] (ssr) warning: Duplicate member "metadata" in class body
290|      constructor(private pluginOptions?: Options) {}
291|  
292|      metadata(cb: (builder: PluginMetadataConfigurable) => void): PluginBuilder<Options> {
   |      ^
293|          const metadataBuilder = this.createMetadataBuilder();
294|          cb(metadataBuilder);

  Plugin: vite:esbuild
  File: /home/engine/project/packages/plugin-sdk/src/builder.ts
3:25:18 PM [vite] (ssr) warning: Duplicate member "recipe" in class body
296|      }
297|  
298|      recipe(recipe: LucidPluginRecipe): PluginBuilder<Options> {
   |      ^
299|          this.recipe = recipe;
300|          return this;

  Plugin: vite:esbuild
  File: /home/engine/project/packages/plugin-sdk/src/builder.ts
3:25:18 PM [vite] (ssr) warning: Duplicate member "hooks" in class body
301|      }
302|  
303|      hooks(cb: (builder: PluginHooksConfigurable) => void): PluginBuilder<Options> {
   |      ^
304|          const configBuilder = this.createHooksBuilder();
305|          cb(configBuilder);

  Plugin: vite:esbuild
  File: /home/engine/project/packages/plugin-sdk/src/builder.ts
3:25:18 PM [vite] (ssr) warning: Duplicate member "routes" in class body
307|      }
308|  
309|      routes(cb: (builder: PluginRoutesConfigurable) => void): PluginBuilder<Options> {
   |      ^
310|          const configBuilder = this.createRoutesBuilder();
311|          cb(configBuilder);

  Plugin: vite:esbuild
  File: /home/engine/project/packages/plugin-sdk/src/builder.ts
3:25:18 PM [vite] (ssr) warning: Duplicate member "middleware" in class body
313|      }
314|  
315|      middleware(cb: (builder: PluginMiddlewareConfigurable) => void): PluginBuilder<Options> {
   |      ^
316|          const configBuilder = this.createMiddlewareBuilder();
317|          cb(configBuilder);

  Plugin: vite:esbuild
  File: /home/engine/project/packages/plugin-sdk/src/builder.ts
3:25:18 PM [vite] (ssr) warning: Duplicate member "services" in class body
319|      }
320|  
321|      services(cb: (builder: PluginServicesConfigurable) => void): PluginBuilder<Options> {
   |      ^
322|          const configBuilder = this.createServicesBuilder();
323|          cb(configBuilder);

  Plugin: vite:esbuild
  File: /home/engine/project/packages/plugin-sdk/src/builder.ts
3:25:18 PM [vite] (ssr) warning: Duplicate member "admin" in class body
325|      }
326|  
327|      admin(cb: (builder: PluginAdminConfigurable) => void): PluginBuilder<Options> {
   |      ^
328|          const configBuilder = this.createAdminBuilder();
329|          cb(configBuilder);

  Plugin: vite:esbuild
  File: /home/engine/project/packages/plugin-sdk/src/builder.ts
 â¯ |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts (14 tests | 14 failed) 21ms
   Ã— Plugin SDK > createPlugin > should create a basic plugin 11ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with all metadata 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with a recipe 2ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with hooks 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with routes 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with middleware 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with services 0ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with admin configuration 0ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should create a plugin with compatibility checker 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should support plugin options 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should handle empty arrays and objects correctly 0ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should build fluent API correctly 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > createPlugin > should generate valid LucidPluginManifest 1ms
     â†’ (0 , createPlugin)(...).metadata is not a function
   Ã— Plugin SDK > type safety > should provide proper TypeScript types 0ms
     â†’ (0 , createPlugin)(...).metadata is not a function
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/media.test.ts (3 tests) 10ms
 âœ“ |@lucidcms/core| src/utils/helpers/group-document-filters.test.ts (10 tests) 13ms
 âœ“ |@lucidcms/core| src/libs/builders/field-builder/field-builder.test.ts (3 tests) 8ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/datetime.test.ts (3 tests) 8ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/text.test.ts (3 tests) 8ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/wysiwyg.test.ts (3 tests) 8ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/link.test.ts (3 tests) 13ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/textarea.test.ts (3 tests) 7ms
 â¯ |@lucidcms/core| src/utils/services/service-wrapper.test.ts (5 tests | 5 skipped) 338ms
   â†“ basic - one level deep service wrapper success and error
   â†“ basic - two level deep service wrapper success and error
   â†“ transaction - one level deep service wrapper success and error
   â†“ transaction - two level deep service wrapper success and error
   â†“ service wrapper schema validation
 âœ“ |@lucidcms/core| src/services/documents-bricks/helpers/prepare-bricks-and-fields.test.ts (3 tests) 4ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/json.test.ts (3 tests) 9ms
 âœ“ |@lucidcms/core| src/services/documents-bricks/checks/check-validate-bricks-fields.test.ts (1 test) 6ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/color.test.ts (3 tests) 7ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/number.test.ts (3 tests) 8ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/select.test.ts (3 tests) 8ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/document.test.ts (3 tests) 6ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/user.test.ts (3 tests) 6ms
 âœ“ |@lucidcms/core| src/services/documents-bricks/helpers/process-field-values.test.ts (6 tests) 4ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/checkbox.test.ts (3 tests) 10ms
 âœ“ |@lucidcms/core| src/libs/plugins/__tests__/plugin-manager.test.ts (6 tests) 30ms
 âœ“ |@lucidcms/core| src/libs/email-adapter/templates/replace-template-vars.test.ts (10 tests) 3ms
 âœ“ |@lucidcms/core| src/libs/builders/collection-builder/collection-builder.test.ts (1 test) 4ms
 âœ“ |@lucidcms/core| src/libs/builders/brick-builder/brick-builder.test.ts (4 tests) 6ms
 âœ“ |@lucidcms/plugin-pages| src/utils/build-fullslug-from-slugs.test.ts (2 tests) 2ms
 âœ“ |@lucidcms/core| src/utils/client-integrations/encode-api-key.test.ts (3 tests) 3ms
 âœ“ |@lucidcms/core| src/libs/builders/collection-builder/schema.test.ts (1 test) 3ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/repeater.test.ts (1 test) 4ms
 â¯ |@lucidcms/core| src/libs/config/mock-config/check-plugin-semver.test.ts (1 test | 1 failed) 299ms
   Ã— should throw lucid version support error 298ms
     â†’ expected [Function] to throw error including 'This plugin does not support version â€¦' but got 'No "exports" main defined in /home/enâ€¦'
 â¯ |@lucidcms/core| src/libs/config/load-config-file.test.ts (2 tests | 2 failed) 383ms
   Ã— should return lucid config object 283ms
     â†’ No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json
   Ã— should return lucid adapter object 98ms
     â†’ No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json
 âœ“ |@lucidcms/core| src/libs/builders/brick-builder/schema.test.ts (1 test) 6ms
 âœ“ |@lucidcms/core| src/libs/custom-fields/fields/tab.test.ts (1 test) 3ms
 âœ“ |@lucidcms/core| src/libs/config/get-config-path.test.ts (2 tests) 6ms
 â¯ |@lucidcms/core| src/libs/config/mock-config/duplicate-collection-fields.test.ts (1 test | 1 failed) 280ms
   Ã— should throw duplicate collection field key error 279ms
     â†’ expected [Function] to throw error including 'Duplicate field keys found (title) inâ€¦' but got 'No "exports" main defined in /home/enâ€¦'
 â¯ |@lucidcms/core| src/libs/config/mock-config/duplicate-collections.test.ts (1 test | 1 failed) 350ms
   Ã— should throw duplicate collection key error 350ms
     â†’ expected [Function] to throw error including 'Duplicate keys found for collections â€¦' but got 'No "exports" main defined in /home/enâ€¦'
 âœ“ |@lucidcms/admin| src/utils/__tests__/plugin-manifest.test.ts (7 tests) 5ms

â¯â¯â¯â¯â¯â¯ Failed Suites 24 â¯â¯â¯â¯â¯â¯

 FAIL  |@lucidcms/core| src/libs/repositories/auth-states.test.ts [ packages/core/src/libs/repositories/auth-states.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/client-integrations.test.ts [ packages/core/src/libs/repositories/client-integrations.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/collection-migrations.test.ts [ packages/core/src/libs/repositories/collection-migrations.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/collections.test.ts [ packages/core/src/libs/repositories/collections.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/email-transactions.test.ts [ packages/core/src/libs/repositories/email-transactions.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/emails.test.ts [ packages/core/src/libs/repositories/emails.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/locales.test.ts [ packages/core/src/libs/repositories/locales.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/media-awaiting-sync.test.ts [ packages/core/src/libs/repositories/media-awaiting-sync.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/media-folders.test.ts [ packages/core/src/libs/repositories/media-folders.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/media-translations.test.ts [ packages/core/src/libs/repositories/media-translations.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/media.test.ts [ packages/core/src/libs/repositories/media.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/options.test.ts [ packages/core/src/libs/repositories/options.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/processed-images.test.ts [ packages/core/src/libs/repositories/processed-images.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/queue-jobs.test.ts [ packages/core/src/libs/repositories/queue-jobs.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/role-permissions.test.ts [ packages/core/src/libs/repositories/role-permissions.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/roles.test.ts [ packages/core/src/libs/repositories/roles.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/user-auth-providers.test.ts [ packages/core/src/libs/repositories/user-auth-providers.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/user-logins.test.ts [ packages/core/src/libs/repositories/user-logins.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/user-roles.test.ts [ packages/core/src/libs/repositories/user-roles.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/user-tokens.test.ts [ packages/core/src/libs/repositories/user-tokens.test.ts ]
 FAIL  |@lucidcms/core| src/libs/repositories/users.test.ts [ packages/core/src/libs/repositories/users.test.ts ]
Error: Failed to resolve entry for package "@lucidcms/sqlite-adapter". The package may have incorrect main/module/exports specified in its package.json.
  Plugin: vite:import-analysis
  File: /home/engine/project/packages/core/src/libs/repositories/auth-states.test.ts:2:26
  1  |  import { describe, afterAll, test, expect } from "vitest";
  2  |  import SQLiteAdapter from "@lucidcms/sqlite-adapter";
     |                             ^
  3  |  import Database from "better-sqlite3";
  4  |  import AuthStatesRepository from "./auth-states";
 â¯ packageEntryFailure ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16198:15
 â¯ resolvePackageEntry ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16195:3
 â¯ tryNodeResolve ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16060:18
 â¯ ResolveIdContext.resolveId ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:15831:19
 â¯ EnvironmentPluginContainer.resolveId ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:42213:17
 â¯ TransformPluginContext.resolve ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:42420:15
 â¯ normalizeUrl ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:40463:26
 â¯ ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:40594:37

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[1/43]â¯

 FAIL  |@lucidcms/core| src/libs/repositories/media-share-links.test.ts [ packages/core/src/libs/repositories/media-share-links.test.ts ]
Error: Failed to resolve entry for package "@lucidcms/sqlite-adapter". The package may have incorrect main/module/exports specified in its package.json.
  Plugin: vite:import-analysis
  File: /home/engine/project/packages/core/src/libs/repositories/media-share-links.test.ts:1:26
  1  |  import SQLiteAdapter from "@lucidcms/sqlite-adapter";
     |                             ^
  2  |  import Database from "better-sqlite3";
  3  |  import { afterAll, describe, expect, test } from "vitest";
 â¯ packageEntryFailure ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16198:15
 â¯ resolvePackageEntry ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16195:3
 â¯ tryNodeResolve ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16060:18
 â¯ ResolveIdContext.resolveId ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:15831:19
 â¯ EnvironmentPluginContainer.resolveId ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:42213:17
 â¯ TransformPluginContext.resolve ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:42420:15
 â¯ normalizeUrl ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:40463:26
 â¯ ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:40594:37

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[2/43]â¯

 FAIL  |@lucidcms/core| src/utils/services/service-wrapper.test.ts [ packages/core/src/utils/services/service-wrapper.test.ts ]
Error: No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json
 â¯ jitiResolve ../../node_modules/jiti/dist/jiti.cjs:1:148703
 â¯ jitiRequire ../../node_modules/jiti/dist/jiti.cjs:1:150290
 â¯ import ../../node_modules/jiti/dist/jiti.cjs:1:158307
 â¯ src/utils/test-helpers/config/lucid.config.ts:1:265
 â¯ eval_evalModule ../../node_modules/jiti/dist/jiti.cjs:1:155533
 â¯ jitiRequire ../../node_modules/jiti/dist/jiti.cjs:1:150967
 â¯ Function.import ../../node_modules/jiti/dist/jiti.cjs:1:158307
 â¯ loadConfigFile src/libs/config/load-config-file.ts:34:34
     32|  });
     33| 
     34|  const configModule = await jiti.import<{
       |                                  ^
     35|   default: AdapterDefineConfig;
     36|   adapter?: RuntimeAdapter;
 â¯ getConfig src/utils/test-helpers/get-test-config.ts:14:25
 â¯ Object.migrate src/utils/test-helpers/get-test-config.ts:21:21
 â¯ src/utils/services/service-wrapper.test.ts:30:19

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[3/43]â¯

 FAIL  |@lucidcms/core| src/libs/collection/schema/infer-schema.test.ts [ packages/core/src/libs/collection/schema/infer-schema.test.ts ]
Error: Failed to resolve entry for package "@lucidcms/sqlite-adapter". The package may have incorrect main/module/exports specified in its package.json.
  Plugin: vite:import-analysis
  File: /home/engine/project/packages/core/src/libs/collection/schema/infer-schema.test.ts:6:26
  4  |  import CollectionBuilder from "../../../libs/builders/collection-builder/index.js";
  5  |  import inferSchema from "./infer-schema.js";
  6  |  import SQLiteAdapter from "@lucidcms/sqlite-adapter";
     |                             ^
  7  |  describe("Schema inference", async () => {
  8  |    let pagesCollection;
 â¯ packageEntryFailure ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16198:15
 â¯ resolvePackageEntry ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16195:3
 â¯ tryNodeResolve ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:16060:18
 â¯ ResolveIdContext.resolveId ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:15831:19
 â¯ EnvironmentPluginContainer.resolveId ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:42213:17
 â¯ TransformPluginContext.resolve ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:42420:15
 â¯ normalizeUrl ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:40463:26
 â¯ ../../node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:40594:37

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[4/43]â¯


â¯â¯â¯â¯â¯â¯ Failed Tests 19 â¯â¯â¯â¯â¯â¯â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a basic plugin
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:8:18
      6|         it("should create a basic plugin", () => {
      7|             const plugin = createPlugin()
      8|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
      9|                 .build();
     10| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[5/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with all metadata
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:19:18
     17|         it("should create a plugin with all metadata", () => {
     18|             const plugin = createPlugin()
     19|                 .metadata((metadata) =>
       |                  ^
     20|                     metadata
     21|                         .key("test-plugin")

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[6/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with a recipe
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:43:18
     41|             const recipe = vi.fn();
     42|             const plugin = createPlugin()
     43|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
     44|                 .recipe(recipe)
     45|                 .build();

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[7/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with hooks
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:57:18
     55| 
     56|             const plugin = createPlugin()
     57|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
     58|                 .hooks((hooks) => {
     59|                     hooks.init(initHook);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[8/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with routes
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:76:18
     74| 
     75|             const plugin = createPlugin()
     76|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
     77|                 .routes((routes) => {
     78|                     routes.add(route1);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[9/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with middleware
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:95:18
     93| 
     94|             const plugin = createPlugin()
     95|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
     96|                 .middleware((middleware) => {
     97|                     middleware.add(middleware1);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[10/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with services
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:114:18
    112| 
    113|             const plugin = createPlugin()
    114|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
    115|                 .services((services) => {
    116|                     services.add("service1", service1);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[11/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with admin configuration
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:131:18
    129|         it("should create a plugin with admin configuration", () => {
    130|             const plugin = createPlugin()
    131|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
    132|                 .admin((admin) => {
    133|                     admin.entry("/admin/test-plugin");

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[12/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should create a plugin with compatibility checker
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:186:18
    184| 
    185|             const plugin = createPlugin()
    186|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
    187|                 .checkCompatibility((checkerFn) => {
    188|                     checkerFn(checker);

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[13/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should support plugin options
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:206:18
    204|                 apiKey: "test-key",
    205|             })
    206|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
    207|                 .recipe(recipe)
    208|                 .build();

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[14/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should handle empty arrays and objects correctly
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:217:18
    215|         it("should handle empty arrays and objects correctly", () => {
    216|             const plugin = createPlugin()
    217|                 .metadata((metadata) => metadata.key("test-plugin"))
       |                  ^
    218|                 .build();
    219| 

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[15/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should build fluent API correctly
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:231:18
    229|         it("should build fluent API correctly", () => {
    230|             const plugin = createPlugin()
    231|                 .metadata((metadata) => {
       |                  ^
    232|                     metadata.key("test-plugin");
    233|                     metadata.name("Test Plugin");

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[16/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > createPlugin > should generate valid LucidPluginManifest
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:263:18
    261|         it("should generate valid LucidPluginManifest", () => {
    262|             const plugin = createPlugin()
    263|                 .metadata((metadata) => {
       |                  ^
    264|                     metadata.key("test-plugin");
    265|                     metadata.name("Test Plugin");

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[17/43]â¯

 FAIL  |@lucidcms/plugin-sdk| test/plugin-sdk.test.ts > Plugin SDK > type safety > should provide proper TypeScript types
TypeError: (0 , createPlugin)(...).metadata is not a function
 â¯ test/plugin-sdk.test.ts:297:18
    295|                 apiKey: "test-key",
    296|             })
    297|                 .metadata((metadata) => {
       |                  ^
    298|                     metadata.key("typed-plugin");
    299|                     metadata.name("Typed Plugin");

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[18/43]â¯

 FAIL  |@lucidcms/core| src/libs/config/load-config-file.test.ts > should return lucid config object
Error: No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json
 â¯ jitiResolve ../../node_modules/jiti/dist/jiti.cjs:1:148703
 â¯ jitiRequire ../../node_modules/jiti/dist/jiti.cjs:1:150290
 â¯ import ../../node_modules/jiti/dist/jiti.cjs:1:158307
 â¯ src/libs/config/mock-config/lucid.config.ts:1:265
 â¯ eval_evalModule ../../node_modules/jiti/dist/jiti.cjs:1:155533
 â¯ jitiRequire ../../node_modules/jiti/dist/jiti.cjs:1:150967
 â¯ Function.import ../../node_modules/jiti/dist/jiti.cjs:1:158307
 â¯ loadConfigFile src/libs/config/load-config-file.ts:34:34
     32|  });
     33| 
     34|  const configModule = await jiti.import<{
       |                                  ^
     35|   default: AdapterDefineConfig;
     36|   adapter?: RuntimeAdapter;
 â¯ src/libs/config/load-config-file.test.ts:6:20

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[19/43]â¯

 FAIL  |@lucidcms/core| src/libs/config/load-config-file.test.ts > should return lucid adapter object
Error: No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json
 â¯ jitiResolve ../../node_modules/jiti/dist/jiti.cjs:1:148703
 â¯ jitiRequire ../../node_modules/jiti/dist/jiti.cjs:1:150290
 â¯ import ../../node_modules/jiti/dist/jiti.cjs:1:158307
 â¯ src/libs/config/mock-config/lucid.config.ts:1:265
 â¯ eval_evalModule ../../node_modules/jiti/dist/jiti.cjs:1:155533
 â¯ jitiRequire ../../node_modules/jiti/dist/jiti.cjs:1:150967
 â¯ Function.import ../../node_modules/jiti/dist/jiti.cjs:1:158307
 â¯ loadConfigFile src/libs/config/load-config-file.ts:34:34
     32|  });
     33| 
     34|  const configModule = await jiti.import<{
       |                                  ^
     35|   default: AdapterDefineConfig;
     36|   adapter?: RuntimeAdapter;
 â¯ src/libs/config/load-config-file.test.ts:15:20

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[20/43]â¯

 FAIL  |@lucidcms/core| src/libs/config/mock-config/check-plugin-semver.test.ts > should throw lucid version support error
AssertionError: expected [Function] to throw error including 'This plugin does not support version â€¦' but got 'No "exports" main defined in /home/enâ€¦'

Expected: [32m"This plugin does not support version 0.12.0 of Lucid, only versions 100.0.0."[39m
Received: [31m"No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json"[39m

 â¯ src/libs/config/mock-config/check-plugin-semver.test.ts:11:2
      9|  const version = semver.coerce(packageJson.version) ?? packageJson.verâ€¦
     10| 
     11|  await expect(
       |  ^
     12|   loadConfigFile({
     13|    path: path.resolve(__dirname, "./check-plugin-semver.ts"),

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[21/43]â¯

 FAIL  |@lucidcms/core| src/libs/config/mock-config/duplicate-collection-fields.test.ts > should throw duplicate collection field key error
AssertionError: expected [Function] to throw error including 'Duplicate field keys found (title) inâ€¦' but got 'No "exports" main defined in /home/enâ€¦'

Expected: [32m"Duplicate field keys found (title) in collection: page."[39m
Received: [31m"No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json"[39m

 â¯ src/libs/config/mock-config/duplicate-collection-fields.test.ts:7:2
      5| 
      6| test("should throw duplicate collection field key error", async () => {
      7|  await expect(
       |  ^
      8|   loadConfigFile({
      9|    path: path.resolve(__dirname, "./duplicate-collection-fields.ts"),

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[22/43]â¯

 FAIL  |@lucidcms/core| src/libs/config/mock-config/duplicate-collections.test.ts > should throw duplicate collection key error
AssertionError: expected [Function] to throw error including 'Duplicate keys found for collections â€¦' but got 'No "exports" main defined in /home/enâ€¦'

Expected: [32m"Duplicate keys found for collections builder."[39m
Received: [31m"No "exports" main defined in /home/engine/project/node_modules/@lucidcms/sqlite-adapter/package.json"[39m

 â¯ src/libs/config/mock-config/duplicate-collections.test.ts:7:2
      5| 
      6| test("should throw duplicate collection key error", async () => {
      7|  await expect(
       |  ^
      8|   loadConfigFile({
      9|    path: path.resolve(__dirname, "./duplicate-collections.ts"),

â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯â¯[23/43]â¯


 Test Files  29 failed | 31 passed (60)
      Tests  19 failed | 103 passed | 5 skipped (127)
   Start at  15:25:16
   Duration  25.62s (transform 4.15s, setup 155ms, collect 24.67s, tests 1.90s, environment 902ms, prepare 7.37s)

